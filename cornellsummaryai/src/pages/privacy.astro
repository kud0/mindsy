---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import { useTranslations } from '../lib/i18n';

// Get user from locals (set by middleware)
const user = Astro.locals.user;
const isAuthenticated = !!user;
const lang = 'en';
const t = useTranslations(lang);
---

<BaseLayout title="Privacy Policy">
  <div class="min-h-screen bg-gradient-to-b from-blue-50 to-white">
    <Navbar
      lang={lang}
      currentPage="privacy"
      isAuthenticated={isAuthenticated}
    />
    
    <!-- Header Section -->
    <section class="pt-20 pb-16">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">
              {t('privacy.title')}
            </h1>
            <p class="text-xl text-gray-600">
              {t('privacy.subtitle')}
            </p>
          </div>
          
          <div class="mb-8">
            <a 
              href="/" 
              class="inline-flex items-center text-blue-600 hover:text-blue-700 transition-colors"
            >
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
              </svg>
              {t('privacy.backHome')}
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Privacy Policy Content Section -->
    <section class="pb-20">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <div class="bg-white rounded-lg shadow-lg p-8 md:p-12">
            <div class="prose prose-lg max-w-none">
              <!-- Last Updated -->
              <div class="mb-8 p-4 bg-blue-50 rounded-lg border border-blue-200">
                <p class="text-sm text-blue-800 font-medium">
                  <strong>{t('privacy.lastUpdated')}:</strong> August 2025
                </p>
              </div>

              <!-- Privacy Policy Content -->
              <div class="space-y-8">
                <p class="text-lg text-gray-700 leading-relaxed">
                  Your privacy is important to us. This Privacy Policy explains how mysummary.app ("we," "us," or "our") collects, uses, and discloses information about you when you use our website, services, and application (collectively, the "Service").
                </p>
                
                <p class="text-gray-700">
                  By using our Service, you agree to the collection and use of information in accordance with this policy.
                </p>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">1. Information We Collect</h2>
                  <p class="text-gray-700 mb-4">We collect information in a few different ways to provide and improve our Service to you.</p>
                  
                  <h3 class="text-xl font-semibold text-gray-900 mb-3">a) Information You Provide to Us:</h3>
                  <ul class="space-y-3 text-gray-700 mb-6">
                    <li>
                      <strong>Account Information:</strong> When you register for an account, we collect your email address and password. If you sign up using a third-party service like Google or GitHub, we will receive information from that service, such as your name and email address, as authorized by you.
                    </li>
                    <li>
                      <strong>Subscription Information:</strong> When you subscribe to a paid plan, our payment processor (Stripe) will collect your payment information. We do not store your full credit card details on our servers. We only store information necessary to manage your subscription, such as your Stripe Customer ID and subscription status.
                    </li>
                    <li>
                      <strong>Communications:</strong> If you contact us directly via our support email (support@mysummary.app), we may receive additional information you provide, such as your name and the contents of your message.
                    </li>
                  </ul>

                  <h3 class="text-xl font-semibold text-gray-900 mb-3">b) Information We Collect Automatically:</h3>
                  <ul class="space-y-3 text-gray-700 mb-6">
                    <li>
                      <strong>Log and Usage Data:</strong> Like most websites, we collect information that your browser sends whenever you visit our Service. This may include your IP address, browser type, browser version, the pages you visit, and the time and date of your visit. This is used for analytics and to secure our Service.
                    </li>
                  </ul>

                  <h3 class="text-xl font-semibold text-gray-900 mb-3">c) Content You Provide for Processing:</h3>
                  <ul class="space-y-3 text-gray-700">
                    <li>
                      <strong>Audio Files:</strong> We collect the audio files you upload for the sole purpose of transcribing them and generating your notes.
                    </li>
                    <li>
                      <strong>Generated Content:</strong> We temporarily process the transcribed text and the final Generated Content (Mindsy Notes, summaries) to create your downloadable PDF.
                    </li>
                  </ul>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">2. How We Use Your Information</h2>
                  <p class="text-gray-700 mb-4">We use the information we collect for the following purposes:</p>
                  <ul class="space-y-3 text-gray-700">
                    <li><strong>To Provide and Maintain our Service:</strong> To create your account, process your audio files, generate your notes, and manage your subscription.</li>
                    <li><strong>To Communicate With You:</strong> To send you transactional emails, such as account verification, password resets, payment confirmations, and important updates about the Service.</li>
                    <li><strong>To Process Payments:</strong> To manage your subscriptions and billing through our payment processor.</li>
                    <li><strong>For Security and Fraud Prevention:</strong> To monitor for and prevent fraudulent or illegal activity.</li>
                    <li><strong>To Improve Our Service:</strong> To analyze usage patterns and understand how to improve the user experience.</li>
                  </ul>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">3. How We Handle Your Content (Audio & Notes)</h2>
                  <p class="text-gray-700 mb-4">Your content is yours. Our handling of it is designed with privacy as a top priority.</p>
                  <ul class="space-y-3 text-gray-700">
                    <li><strong>Processing:</strong> Your uploaded audio files are sent to our secure, self-hosted transcription service (running on RunPod) for processing. The resulting transcript is then sent to the OpenAI API for note generation. We do not use your content to train our or third-party AI models.</li>
                    <li><strong>Storage:</strong> Your original audio files and final generated PDFs are stored securely in your private Supabase Storage bucket. Access is restricted by security policies to only your account.</li>
                    <li><strong>Data Retention:</strong> We retain your uploaded files and generated notes for as long as your account is active, to allow you to access them from your dashboard. You can delete your files and your account at any time. When you delete a file or your account, it is permanently removed from our storage.</li>
                  </ul>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">4. Sharing and Disclosure of Information</h2>
                  <p class="text-gray-700 mb-4">We do not sell or rent your personal information. We only share your information with trusted third-party service providers who help us operate our Service, under strict privacy agreements. These include:</p>
                  <ul class="space-y-2 text-gray-700 mb-4">
                    <li><strong>Supabase:</strong> Our database, authentication, and file storage provider.</li>
                    <li><strong>Vercel:</strong> Our web hosting provider.</li>
                    <li><strong>Stripe:</strong> Our payment processor.</li>
                    <li><strong>Resend:</strong> Our transactional email provider.</li>
                    <li><strong>RunPod & Railway:</strong> Our infrastructure providers for our self-hosted AI models.</li>
                    <li><strong>OpenAI:</strong> The provider of the AI model for generating notes.</li>
                  </ul>
                  <p class="text-gray-700">We may also disclose your information if required by law or to protect the rights, property, or safety of ourselves, our users, or others.</p>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">5. Your Data Rights (GDPR)</h2>
                  <p class="text-gray-700 mb-4">If you are a resident of the European Economic Area (EEA), you have certain data protection rights. We aim to take reasonable steps to allow you to correct, amend, delete, or limit the use of your Personal Data.</p>
                  <ul class="space-y-3 text-gray-700 mb-4">
                    <li>You can access and update your account information at any time through your account settings.</li>
                    <li>You can delete your files or your entire account from the dashboard.</li>
                    <li>You have the right to data portability and the right to withdraw consent.</li>
                  </ul>
                  <p class="text-gray-700">To exercise any of these rights, please contact us at <strong>support@mysummary.app</strong>.</p>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">6. Security</h2>
                  <p class="text-gray-700">
                    The security of your data is a top priority. We use industry-standard administrative, technical, and physical security measures to protect your information. Our platform is built on trusted providers like Supabase and Vercel, which employ robust security practices.
                  </p>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">7. Governing Law</h2>
                  <p class="text-gray-700">
                    This Privacy Policy is governed by the laws of <strong>Spain</strong>.
                  </p>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">8. Changes to This Privacy Policy</h2>
                  <p class="text-gray-700">
                    We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new policy on this page and updating the "Last Updated" date at the top.
                  </p>
                </section>

                <section>
                  <h2 class="text-2xl font-bold text-gray-900 mb-4">9. Contact Us</h2>
                  <p class="text-gray-700">
                    If you have any questions about this Privacy Policy, please contact us at <strong>support@mysummary.app</strong>.
                  </p>
                </section>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <Footer lang={lang} isAuthenticated={isAuthenticated} />
  </div>
</BaseLayout>